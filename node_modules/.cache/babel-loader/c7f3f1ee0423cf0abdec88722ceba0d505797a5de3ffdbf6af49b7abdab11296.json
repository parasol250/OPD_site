{"ast":null,"code":"import React from'react';import defaultImage from'./default-product-image.jpg';// Запасное изображение\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProductCard=_ref=>{let{product}=_ref;// Проверяем наличие product и его свойств\nif(!product){return/*#__PURE__*/_jsx(\"div\",{className:\"product-card error\",children:\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430: \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435 \\u0442\\u043E\\u0432\\u0430\\u0440\\u0430 \\u043D\\u0435 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0436\\u0435\\u043D\\u044B\"});}// Construct image path\nconst getImageSource=()=>{if(product.image_paths){const pathsArray=Array.isArray(product.image_paths)?product.image_paths:String(product.image_paths).split(',').map(path=>path.trim());if(pathsArray.length>0){const firstPath=pathsArray[0];const cleanPath=firstPath.startsWith('full/')?firstPath.substring(5):firstPath;return`/images/full/${cleanPath}`;}}if(product.images&&product.images.length>0){return product.images[0];}return defaultImage;};// // Проверяем данные в консоли для отладки\n// console.log('Product data:', {\n//   id: product.id,\n//   name: product.name,\n//   images: product.images,\n//   image_paths: product.image_paths,\n//   resolvedImage: getImageSource(),\n//   original_url: product.original_url\n// });\n// Format price\nconst formattedPrice=product.price?`${product.price.toLocaleString('ru-RU')} руб.`:'Цена не указана';const handleShopClick=url=>{// Проверяем что url существует и является строкой\nif(!url||typeof url!=='string'){console.error('Invalid URL:',url);return;}try{// Ensure URL is properly encoded\nconst encodedUrl=encodeURI(url.trim());// Verify URL structure\nconst validatedUrl=new URL(encodedUrl);window.open(validatedUrl.href,'_blank','noopener noreferrer');}catch(e){console.error('Invalid URL format:',url,e);// Optional: Show user feedback\nalert('Невозможно открыть ссылку на магазин');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:getImageSource(),alt:product.name||'Изображение товара',className:\"product-image\",onError:e=>{console.error('Image load error:',{attemptedUrl:e.target.src,productId:product.id,error:e.nativeEvent});e.target.src=defaultImage;}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),product.description&&/*#__PURE__*/_jsx(\"p\",{className:\"description\",children:product.description}),/*#__PURE__*/_jsx(\"p\",{className:\"price\",children:formattedPrice}),product.shop_name&&/*#__PURE__*/_jsxs(\"p\",{className:\"store\",children:[\"\\u041C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D: \",product.shop_name]}),product.original_url?/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleShopClick(product.original_url),className:\"shop-button\",children:\"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u0432 \\u043C\\u0430\\u0433\\u0430\\u0437\\u0438\\u043D\"}):/*#__PURE__*/_jsx(\"button\",{className:\"shop-button disabled\",disabled:true,children:\"\\u0421\\u0441\\u044B\\u043B\\u043A\\u0430 \\u043D\\u0435\\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430\"})]})]});};export default ProductCard;","map":{"version":3,"names":["React","defaultImage","jsx","_jsx","jsxs","_jsxs","ProductCard","_ref","product","className","children","getImageSource","image_paths","pathsArray","Array","isArray","String","split","map","path","trim","length","firstPath","cleanPath","startsWith","substring","images","formattedPrice","price","toLocaleString","handleShopClick","url","console","error","encodedUrl","encodeURI","validatedUrl","URL","window","open","href","e","alert","src","alt","name","onError","attemptedUrl","target","productId","id","nativeEvent","description","shop_name","original_url","onClick","disabled"],"sources":["C:/Users/Yulia/OneDrive - Peter the Great St. Petersburg Polytechnical University/Рабочий стол/bound/OPD_site/src/components/ProductCard.js"],"sourcesContent":["import React from 'react';\r\nimport defaultImage from './default-product-image.jpg'; // Запасное изображение\r\n\r\nconst ProductCard = ({ product }) => {\r\n  // Проверяем наличие product и его свойств\r\n  if (!product) {\r\n    return <div className=\"product-card error\">Ошибка: данные товара не загружены</div>;\r\n  }\r\n  // Construct image path\r\n  const getImageSource = () => {\r\n    if (product.image_paths) {\r\n      const pathsArray = Array.isArray(product.image_paths) \r\n        ? product.image_paths \r\n        : String(product.image_paths).split(',').map(path => path.trim());\r\n      \r\n      if (pathsArray.length > 0) {\r\n        const firstPath = pathsArray[0];\r\n        const cleanPath = firstPath.startsWith('full/') \r\n          ? firstPath.substring(5) \r\n          : firstPath;\r\n        return `/images/full/${cleanPath}`;\r\n      }\r\n    }\r\n    \r\n    if (product.images && product.images.length > 0) {\r\n      return product.images[0];\r\n    }\r\n    \r\n    return defaultImage;\r\n  };\r\n\r\n  // // Проверяем данные в консоли для отладки\r\n  // console.log('Product data:', {\r\n  //   id: product.id,\r\n  //   name: product.name,\r\n  //   images: product.images,\r\n  //   image_paths: product.image_paths,\r\n  //   resolvedImage: getImageSource(),\r\n  //   original_url: product.original_url\r\n  // });\r\n\r\n  // Format price\r\n  const formattedPrice = product.price ? \r\n  `${product.price.toLocaleString('ru-RU')} руб.` : \r\n  'Цена не указана';\r\n\r\n  const handleShopClick = (url) => {\r\n    // Проверяем что url существует и является строкой\r\n    if (!url || typeof url !== 'string') {\r\n      console.error('Invalid URL:', url);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Ensure URL is properly encoded\r\n      const encodedUrl = encodeURI(url.trim());\r\n      // Verify URL structure\r\n      const validatedUrl = new URL(encodedUrl);\r\n      window.open(validatedUrl.href, '_blank', 'noopener noreferrer');\r\n    } catch (e) {\r\n      console.error('Invalid URL format:', url, e);\r\n      // Optional: Show user feedback\r\n      alert('Невозможно открыть ссылку на магазин');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"product-card\">\r\n      <div className=\"product-image-container\">\r\n          <img\r\n              src={getImageSource()} \r\n              alt={product.name || 'Изображение товара'}\r\n              className=\"product-image\"\r\n              onError={(e) => {\r\n                console.error('Image load error:', {\r\n                  attemptedUrl: e.target.src,\r\n                  productId: product.id,\r\n                  error: e.nativeEvent\r\n                });\r\n                  e.target.src = defaultImage;\r\n              }}\r\n          />\r\n      </div>\r\n      <div className=\"product-info\">\r\n        <h3>{product.name}</h3>\r\n        {product.description && <p className=\"description\">{product.description}</p>}\r\n        <p className=\"price\">{formattedPrice}</p>\r\n        {product.shop_name && <p className=\"store\">Магазин: {product.shop_name}</p>}\r\n        {product.original_url ? (\r\n          <button \r\n            onClick={() => handleShopClick(product.original_url)}\r\n            className=\"shop-button\"\r\n          >\r\n            Перейти в магазин\r\n          </button>\r\n        ) : (\r\n          <button className=\"shop-button disabled\" disabled>\r\n            Ссылка недоступна\r\n          </button>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProductCard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}