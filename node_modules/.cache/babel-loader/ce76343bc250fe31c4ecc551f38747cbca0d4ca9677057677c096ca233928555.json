{"ast":null,"code":"import React,{useState,useEffect}from'react';import Header from'./components/Header';import ProductList from'./components/ProductList';//import FilterSidebar from './components/FilterSidebar';\nimport Popup from'./components/popup';import'./App.css';import{BrowserRouter,Route,Routes,useParams,useNavigate}from'react-router-dom';import CategoryPage from'./components/CategoryPage';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AppContent(){const[products,setProducts]=useState([]);const[filters,setFilters]=useState({});const[searchTerm,setSearchTerm]=useState('');// Добавили state для поиска\nconst[isPopupOpen,setIsPopupOpen]=useState(false);// State для открытия/закрытия popup\nconst[isLoggedIn,setIsLoggedIn]=useState(false);// Состояние аутентификации (пример)\nconst[error,setError]=useState(null);const[loading,setLoading]=useState(true);const navigate=useNavigate();// Имитация API вызова (замените реальным API)\nuseEffect(()=>{const fetchData=async()=>{setLoading(true);try{const response=await fetch('http://localhost:5000/api/products');if(!response.ok){throw new Error(`HTTP error! Status: ${response.status}`);}const data=await response.json();// Перемешиваем продукты для случайного порядка\nsetProducts(shuffleArray(data));// Исправлено: сохраняем shuffledProducts\n// Перенаправляем на главную только если мы уже не на категории\nif(!window.location.pathname.includes('/category')){navigate('/',{replace:true});}}catch(error){setError(error);console.error(\"Error fetching data:\",error);// <---- Добавили console.error\n}finally{setLoading(false);}};fetchData();},[navigate]);// Функция для перемешивания массива (алгоритм Фишера-Йетса)\nconst shuffleArray=array=>{const newArray=[...array];for(let i=newArray.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[newArray[i],newArray[j]]=[newArray[j],newArray[i]];}return newArray;};const handleFilterChange=newFilters=>{setFilters(newFilters);//Здесь нужно реализовать отправку фильтров на API\n//И обновить стейт products на основе результатов\nconsole.log('New filters:',newFilters);};const handleSearch=term=>{// Добавили обработчик поиска\nsetSearchTerm(term);};const handleOpenPopup=()=>{// Функция для открытия всплывающего окна\nsetIsPopupOpen(true);};const handleClosePopup=()=>{// Функция для закрытия всплывающего окна\nsetIsPopupOpen(false);};// New function to handle login from Popup\nconst handleLogin=()=>{setIsLoggedIn(true);setIsPopupOpen(false);// close the popup after successful login\n};// New function to handle register from Popup (just close popup as example)\nconst handleRegister=()=>{setIsLoggedIn(true);setIsPopupOpen(false);// close the popup after successful register, also login as example\n};// const handleCategorySelect = (category) => {\n//   navigate(`/category/${category}`);\n// };\nconst filteredProducts=products.filter(product=>{return product.name.toLowerCase().includes(searchTerm.toLowerCase());// const searchTermLower = searchTerm.toLowerCase();\n// const productNameLower = product.name.toLowerCase();\n// const searchMatch = productNameLower.includes(searchTermLower); // Фильтруем по названию\n// // Category filter\n// if (selectedCategory) {\n//   return product.category === selectedCategory && searchMatch; // Search only within selected category\n// } else {\n//   return searchMatch; // Search across all products when no category is selected\n// }\n});if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error.message]});return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsx(Header,{onOpenPopup:()=>setIsPopupOpen(true),onSearch:handleSearch,onFilterChange:handleFilterChange,isLoggedIn:isLoggedIn}),/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ProductList,{products:filteredProducts})}),/*#__PURE__*/_jsx(Route,{path:\"/category/:categoryName\",element:/*#__PURE__*/_jsx(CategoryPage,{products:products,searchTerm:searchTerm,loading:loading,error:error})})]})}),isPopupOpen&&/*#__PURE__*/_jsx(Popup,{isOpen:isPopupOpen,onClose:()=>setIsPopupOpen(false),onLogin:()=>setIsLoggedIn(true),onRegister:()=>setIsLoggedIn(true)})]});}function App(){return/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsx(AppContent,{})});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Header","ProductList","Popup","BrowserRouter","Route","Routes","useParams","useNavigate","CategoryPage","jsx","_jsx","jsxs","_jsxs","AppContent","products","setProducts","filters","setFilters","searchTerm","setSearchTerm","isPopupOpen","setIsPopupOpen","isLoggedIn","setIsLoggedIn","error","setError","loading","setLoading","navigate","fetchData","response","fetch","ok","Error","status","data","json","shuffleArray","window","location","pathname","includes","replace","console","array","newArray","i","length","j","Math","floor","random","handleFilterChange","newFilters","log","handleSearch","term","handleOpenPopup","handleClosePopup","handleLogin","handleRegister","filteredProducts","filter","product","name","toLowerCase","children","message","className","onOpenPopup","onSearch","onFilterChange","path","element","isOpen","onClose","onLogin","onRegister","App"],"sources":["C:/Users/Yulia/OneDrive - Peter the Great St. Petersburg Polytechnical University/Рабочий стол/bound/OPD_site/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Header from './components/Header';\r\nimport ProductList from './components/ProductList';\r\n//import FilterSidebar from './components/FilterSidebar';\r\nimport Popup from './components/popup';\r\nimport './App.css';\r\nimport { BrowserRouter, Route, Routes, useParams, useNavigate  } from 'react-router-dom';\r\nimport CategoryPage from './components/CategoryPage';\r\n\r\nfunction AppContent() {\r\n  const [products, setProducts] = useState([]);\r\n  const [filters, setFilters] = useState({});\r\n  const [searchTerm, setSearchTerm] = useState(''); // Добавили state для поиска\r\n  const [isPopupOpen, setIsPopupOpen] = useState(false); // State для открытия/закрытия popup\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false); // Состояние аутентификации (пример)\r\n  const [error, setError] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const navigate = useNavigate();\r\n\r\n\r\n  // Имитация API вызова (замените реальным API)\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const response = await fetch('http://localhost:5000/api/products');\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP error! Status: ${response.status}`);\r\n        }\r\n        const data = await response.json();\r\n        // Перемешиваем продукты для случайного порядка\r\n        setProducts(shuffleArray(data)); // Исправлено: сохраняем shuffledProducts\r\n        // Перенаправляем на главную только если мы уже не на категории\r\n        if (!window.location.pathname.includes('/category')) {\r\n          navigate('/', { replace: true });\r\n        }\r\n      } catch (error) {\r\n        setError(error);\r\n        console.error(\"Error fetching data:\", error); // <---- Добавили console.error\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [navigate]);\r\n\r\n  // Функция для перемешивания массива (алгоритм Фишера-Йетса)\r\n  const shuffleArray = (array) => {\r\n    const newArray = [...array];\r\n    for (let i = newArray.length - 1; i > 0; i--) {\r\n      const j = Math.floor(Math.random() * (i + 1));\r\n      [newArray[i], newArray[j]] = [newArray[j], newArray[i]];\r\n    }\r\n    return newArray;\r\n  };\r\n\r\n  const handleFilterChange = (newFilters) => {\r\n    setFilters(newFilters);\r\n    //Здесь нужно реализовать отправку фильтров на API\r\n    //И обновить стейт products на основе результатов\r\n    console.log('New filters:', newFilters);\r\n  };\r\n\r\n  const handleSearch = (term) => { // Добавили обработчик поиска\r\n    setSearchTerm(term);\r\n  };\r\n\r\n  const handleOpenPopup = () => { // Функция для открытия всплывающего окна\r\n    setIsPopupOpen(true);\r\n  };\r\n\r\n  const handleClosePopup = () => { // Функция для закрытия всплывающего окна\r\n    setIsPopupOpen(false);\r\n  };\r\n\r\n  // New function to handle login from Popup\r\n  const handleLogin = () => {\r\n    setIsLoggedIn(true);\r\n    setIsPopupOpen(false);  // close the popup after successful login\r\n  };\r\n\r\n    // New function to handle register from Popup (just close popup as example)\r\n  const handleRegister = () => {\r\n    setIsLoggedIn(true);\r\n    setIsPopupOpen(false);  // close the popup after successful register, also login as example\r\n  };\r\n\r\n  // const handleCategorySelect = (category) => {\r\n  //   navigate(`/category/${category}`);\r\n  // };\r\n\r\nconst filteredProducts = products.filter(product => {\r\n  return product.name.toLowerCase().includes(searchTerm.toLowerCase());\r\n  // const searchTermLower = searchTerm.toLowerCase();\r\n  // const productNameLower = product.name.toLowerCase();\r\n  // const searchMatch = productNameLower.includes(searchTermLower); // Фильтруем по названию\r\n  // // Category filter\r\n  // if (selectedCategory) {\r\n  //   return product.category === selectedCategory && searchMatch; // Search only within selected category\r\n  // } else {\r\n  //   return searchMatch; // Search across all products when no category is selected\r\n  // }\r\n  });\r\n\r\n  if (loading) return <div>Loading...</div>;\r\n  if (error)return <div>Error: {error.message}</div>;\r\n\r\n  return (\r\n    <div className=\"app-container\">\r\n      <Header\r\n        onOpenPopup={() => setIsPopupOpen(true)}\r\n        onSearch={handleSearch}\r\n        onFilterChange={handleFilterChange}\r\n        isLoggedIn={isLoggedIn}\r\n      />\r\n      <div className=\"main-content\">\r\n        <Routes>\r\n          <Route path=\"/\" element={            \r\n            <ProductList products={filteredProducts} />\r\n            } />\r\n          <Route \r\n            path=\"/category/:categoryName\" \r\n            element={\r\n              <CategoryPage \r\n                products={products} \r\n                searchTerm={searchTerm} \r\n                loading={loading}\r\n                error={error}\r\n              />\r\n            } \r\n          />\r\n          {/* <Route path=\"/category/:categoryName\" element={<CategoryPage />} /> */}\r\n        </Routes>\r\n      </div>\r\n\r\n      {isPopupOpen && (\r\n        <Popup\r\n          isOpen={isPopupOpen}\r\n          onClose={() => setIsPopupOpen(false)}\r\n          onLogin={() => setIsLoggedIn(true)}\r\n          onRegister={() => setIsLoggedIn(true)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction App() {\r\n  return (\r\n    <BrowserRouter>\r\n      <AppContent />\r\n    </BrowserRouter>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}